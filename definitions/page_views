config {  
  type: "view",
  description: "A list of page views with dates & page titles."
}
SELECT
  user_pseudo_id,
  ga_session_id,
  event_date,
  page_location AS page,
  engagement_time_msec / 1000 AS engagement_time_secs,
  platform
FROM
  ${ref("ga4flattening-flat")}
WHERE
  ga_session_id is NOT NULL --only want events that have a session
  AND event_name = 'page_view'
